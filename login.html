<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login - Smart Attendance</title>
<link rel="stylesheet" href="style.css">

<!-- Firebase Libraries -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script src="./firebase.js"></script>

<style>
body { font-family: Arial, sans-serif; background:#f4f4f9; margin:0; padding:0; }
.login-container { max-width:350px; margin:100px auto; padding:20px; background:white; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.1); text-align:center; }
input { width:90%; padding:10px; margin:8px 0; border-radius:4px; border:1px solid #ccc; }
.btn { padding:10px 20px; margin:5px; border:none; border-radius:4px; cursor:pointer; background:#4CAF50; color:white; font-weight:bold; }
.btn:hover { background:#45a049; }
</style>
</head>
<body>

<div class="login-container">
  <h2>ðŸ“š Smart Attendance Login</h2>
  <input type="email" id="email" placeholder="Email"><br>
  <input type="password" id="password" placeholder="Password"><br>
  <button class="btn" onclick="login('admin')">Login as Admin</button>
  <button class="btn" onclick="login('teacher')">Login as Teacher</button>
  <button class="btn" onclick="login('student')">Login as Student</button>
</div>

<script>
function login(type){
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();

  if(!email || !password){
    alert("Please enter both email and password!");
    return;
  }

  auth.signInWithEmailAndPassword(email,password)
    .then(userCred=>{
      const uid = userCred.user.uid;

      // Check type in database to ensure correct redirect
      if(type === "admin"){
        database.ref(`admins/${uid}`).once("value").then(snap=>{
          if(snap.exists()) window.location = "admin.html";
          else alert("You are not registered as Admin!");
        });
      } else if(type === "teacher"){
        database.ref(`teachers/${uid}`).once("value").then(snap=>{
          if(snap.exists()) window.location = "teacher.html";
          else alert("You are not registered as Teacher!");
        });
      } else if(type === "student"){
        database.ref(`students/${uid}`).once("value").then(snap=>{
          if(snap.exists()) window.location = "student.html";
          else alert("You are not registered as Student!");
        });
      }
    })
    .catch(err=>{
      alert(err.message);
    });
}
</script>

</body>
</html>
