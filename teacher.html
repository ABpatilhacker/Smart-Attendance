<!-- Same sidebar, just change functions for teacher -->
<h2>Your Classes</h2>
<div id="class-list"></div>

<script>
let currentTeacherId="";
auth.onAuthStateChanged(user=>{
  if(!user) window.location='login.html';
  currentTeacherId=user.uid;
  loadClasses();
});

// Load teacher classes
function loadClasses(){
  database.ref(`teachers/${currentTeacherId}/classes`).once('value', snap=>{
    const div=document.getElementById("class-list");
    div.innerHTML="";
    snap.forEach(c=>{
      const card=document.createElement("div");
      card.className="card";
      card.innerHTML=`<h4>${c.key}</h4>
        <button class="btn" onclick="viewClass('${c.key}')">View Students</button>
        <button class="btn" onclick="addStudentForm('${c.key}')">Add Student</button>`;
      div.appendChild(card);
    });
  });
}

// View students and mark attendance
function viewClass(className){
  const studentDiv=document.getElementById("main-content");
  studentDiv.innerHTML=`<h3>${className} Students</h3><div id="students-list"></div>`;
  database.ref(`teachers/${currentTeacherId}/classes/${className}/students`).once("value", snap=>{
    const list=document.getElementById("students-list");
    snap.forEach(s=>{
      const stu=s.val();
      const div=document.createElement("div");
      div.innerHTML=`${stu.name} (Roll: ${s.key})
        <button class="btn present" onclick="mark('${className}','${s.key}','present',this)">Present</button>
        <button class="btn absent" onclick="mark('${className}','${s.key}','absent',this)">Absent</button>`;
      list.appendChild(div);
    });
  });
}

// Mark attendance
function mark(className, roll, status, btn){
  const date=new Date().toISOString().split('T')[0];
  database.ref(`teachers/${currentTeacherId}/classes/${className}/attendance/${date}/${roll}`).set(status);
  btn.style.background=status==='present'?'#4CAF50':'#f44336';
}

// Add student
function addStudentForm(className){
  const div=document.getElementById("main-content");
  div.innerHTML=`<h3>Add Student to ${className}</h3>
    <input type="text" id="sname" placeholder="Student Name">
    <input type="text" id="sroll" placeholder="Roll Number">
    <button class="btn" onclick="addStudent('${className}')">Add</button>`;
}

function addStudent(className){
  const name=document.getElementById("sname").value;
  const roll=document.getElementById("sroll").value;
  database.ref(`teachers/${currentTeacherId}/classes/${className}/students/${roll}`).set({name});
  database.ref(`students/${roll}`).set({name, rollNumber:roll});
  alert("Student added!");
  loadClasses();
}
</script>
